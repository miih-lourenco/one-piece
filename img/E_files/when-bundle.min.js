// when - 3.7.7-ef.1 @ 2017-02-17 14:35:06 
!function(a){"use strict";a("when/lib/env",["require"],function(a){function b(){return"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)}function c(){return"undefined"!=typeof MutationObserver&&MutationObserver||"undefined"!=typeof WebKitMutationObserver&&WebKitMutationObserver}function d(a){function b(){var a=c;c=void 0,a()}var c,d=document.createTextNode(""),e=new a(b);e.observe(d,{characterData:!0});var f=0;return function(a){c=a,d.data=f^=1}}var e,f="undefined"!=typeof setTimeout&&setTimeout,g=function(a,b){return setTimeout(a,b)},h=function(a){return clearTimeout(a)},i=function(a){return f(a,0)};if(b())i=function(a){return process.nextTick(a)};else if(e=c())i=d(e);else if(!f){var j=a,k=j("vertx");g=function(a,b){return k.setTimer(b,a)},h=k.cancelTimer,i=k.runOnLoop||k.runOnContext}return{setTimer:g,clearTimer:h,asap:i}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/lib/TimeoutError",[],function(){function a(b){Error.call(this),this.message=b,this.name=a.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/decorators/timed",["require","../env","../TimeoutError"],function(a){function b(a,b,d,e){return c.setTimer(function(){a(d,e,b)},b)}var c=a("../env"),d=a("../TimeoutError");return function(a){function e(a,c,d){b(f,a,c,d)}function f(a,b){b.resolve(a)}function g(a,b,c){var e="undefined"==typeof a?new d("timed out after "+c+"ms"):a;b.reject(e)}return a.prototype.delay=function(a){var b=this._beget();return this._handler.fold(e,a,void 0,b._handler),b},a.prototype.timeout=function(a,d){var e=this._beget(),f=e._handler,h=b(g,a,d,e._handler);return this._handler.visit(f,function(a){c.clearTimer(h),this.resolve(a)},function(a){c.clearTimer(h),this.reject(a)},f.notify),e},a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/lib/state",[],function(){function a(){return{state:"pending"}}function b(a){return{state:"rejected",reason:a}}function c(a){return{state:"fulfilled",value:a}}function d(d){var e=d.state();return 0===e?a():e>0?c(d.value):b(d.value)}return{pending:a,fulfilled:c,rejected:b,inspect:d}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/apply",[],function(){function a(a,c){function d(b,d,f){var g=a._defer(),h=f.length,i=new Array(h);return e({f:b,thisArg:d,args:f,params:i,i:h-1,call:c},g._handler),g}function e(b,d){if(b.i<0)return c(b.f,b.thisArg,b.params,d);var e=a._handler(b.args[b.i]);e.fold(f,b,void 0,d)}function f(a,b,c){a.params[a.i]=b,a.i-=1,e(a,c)}return arguments.length<2&&(c=b),d}function b(a,b,c,d){try{d.resolve(a.apply(b,c))}catch(a){d.reject(a)}}return a.tryCatchResolve=b,a})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/decorators/array",["require","../state","../apply"],function(a){var b=a("../state"),c=a("../apply");return function(a){function d(b){function c(a){k=null,this.resolve(a)}function d(a){this.resolved||(k.push(a),0===--j&&this.reject(k))}for(var e,f,g=a._defer(),h=g._handler,i=b.length>>>0,j=i,k=[],l=0;l<i;++l)if(f=b[l],void 0!==f||l in b){if(e=a._handler(f),e.state()>0){h.become(e),a._visitRemaining(b,l,e);break}e.visit(h,c,d)}else--j;return 0===j&&h.reject(new RangeError("any(): array must not be empty")),g}function e(b,c){function d(a){this.resolved||(k.push(a),0===--n&&(l=null,this.resolve(k)))}function e(a){this.resolved||(l.push(a),0===--f&&(k=null,this.reject(l)))}var f,g,h,i=a._defer(),j=i._handler,k=[],l=[],m=b.length>>>0,n=0;for(h=0;h<m;++h)g=b[h],(void 0!==g||h in b)&&++n;for(c=Math.max(c,0),f=n-c+1,n=Math.min(c,n),c>n?j.reject(new RangeError("some(): array must contain at least "+c+" item(s), but had "+n)):0===n&&j.resolve(k),h=0;h<m;++h)g=b[h],(void 0!==g||h in b)&&a._handler(g).visit(j,d,e,j.notify);return i}function f(b,c){return a._traverse(c,b)}function g(b,c){var d=s.call(b);return a._traverse(c,d).then(function(a){return h(d,a)})}function h(b,c){for(var d=c.length,e=new Array(d),f=0,g=0;f<d;++f)c[f]&&(e[g++]=a._handler(b[f]).value);return e.length=g,e}function i(a){return p(a.map(j))}function j(c){var d;return c instanceof a&&(d=c._handler.join()),d&&0===d.state()||!d?o(c).then(b.fulfilled,b.rejected):(d._unreport(),b.inspect(d))}function k(a,b){return arguments.length>2?q.call(a,m(b),arguments[2]):q.call(a,m(b))}function l(a,b){return arguments.length>2?r.call(a,m(b),arguments[2]):r.call(a,m(b))}function m(a){return function(b,c,d){return n(a,void 0,[b,c,d])}}var n=c(a),o=a.resolve,p=a.all,q=Array.prototype.reduce,r=Array.prototype.reduceRight,s=Array.prototype.slice;return a.any=d,a.some=e,a.settle=i,a.map=f,a.filter=g,a.reduce=k,a.reduceRight=l,a.prototype.spread=function(a){return this.then(p).then(function(b){return a.apply(this,b)})},a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/lib/decorators/flow",[],function(){function a(){throw new TypeError("catch predicate must be a function")}function b(a,b){return c(b)?a instanceof b:b(a)}function c(a){return a===Error||null!=a&&a.prototype instanceof Error}function d(a){return("object"==typeof a||"function"==typeof a)&&null!==a}function e(a){return a}return function(c){function f(a,c){return function(d){return b(d,c)?a.call(this,d):j(d)}}function g(a,b,c,e){var f=a.call(b);return d(f)?h(f,c,e):c(e)}function h(a,b,c){return i(a).then(function(){return b(c)})}var i=c.resolve,j=c.reject,k=c.prototype.catch;return c.prototype.done=function(a,b){this._handler.visit(this._handler.receiver,a,b)},c.prototype.catch=c.prototype.otherwise=function(b){return arguments.length<2?k.call(this,b):"function"!=typeof b?this.ensure(a):k.call(this,f(arguments[1],b))},c.prototype.finally=c.prototype.ensure=function(a){return"function"!=typeof a?this:this.then(function(b){return g(a,this,e,b)},function(b){return g(a,this,j,b)})},c.prototype.else=c.prototype.orElse=function(a){return this.then(void 0,function(){return a})},c.prototype.yield=function(a){return this.then(function(){return a})},c.prototype.tap=function(a){return this.then(a).yield(this)},c}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/decorators/fold",[],function(){return function(a){return a.prototype.fold=function(b,c){var d=this._beget();return this._handler.fold(function(c,d,e){a._handler(c).fold(function(a,c,d){d.resolve(b.call(this,c,a))},d,this,e)},c,d._handler.receiver,d._handler),d},a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/decorators/inspect",["require","../state"],function(a){var b=a("../state").inspect;return function(a){return a.prototype.inspect=function(){return b(a._handler(this))},a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/lib/decorators/iterate",[],function(){return function(a){function b(a,b,d,e){return c(function(b){return[b,a(b)]},b,d,e)}function c(a,b,e,f){function g(f,g){return d(e(f)).then(function(){return c(a,b,e,g)})}return d(f).then(function(c){return d(b(c)).then(function(b){return b?c:d(a(c)).spread(g)})})}var d=a.resolve;return a.iterate=b,a.unfold=c,a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/decorators/progress",[],function(){return function(a){return a.prototype.progress=function(a){return this.then(void 0,void 0,a)},a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/decorators/with",[],function(){return function(a){return a.prototype.with=a.prototype.withThis=function(a){var b=this._beget(),c=b._handler;return c.receiver=a,this._handler.chain(c,a),b},a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/format",[],function(){function a(a){var c="object"==typeof a&&null!==a&&(a.stack||a.message)?a.stack||a.message:b(a);return a instanceof Error?c:c+" (WARNING: non-Error used)"}function b(a){var b=String(a);return"[object Object]"===b&&"undefined"!=typeof JSON&&(b=c(a,b)),b}function c(a,b){try{return JSON.stringify(a)}catch(a){return b}}return{formatError:a,formatObject:b,tryStringify:c}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/decorators/unhandledRejection",["require","../env","../format"],function(a){function b(a){throw a}function c(){}var d=a("../env").setTimer,e=a("../format");return function(a){function f(a){a.handled||(n.push(a),k("Potentially unhandled rejection ["+a.id+"] "+e.formatError(a.value)))}function g(a){var b=n.indexOf(a);b>=0&&(n.splice(b,1),l("Handled previous rejection ["+a.id+"] "+e.formatObject(a.value)))}function h(a,b){m.push(a,b),null===o&&(o=d(i,0))}function i(){for(o=null;m.length>0;)m.shift()(m.shift())}var j,k=c,l=c;"undefined"!=typeof console&&(j=console,k="undefined"!=typeof j.error?function(a){j.error(a)}:function(a){j.log(a)},l="undefined"!=typeof j.info?function(a){j.info(a)}:function(a){j.log(a)}),a.onPotentiallyUnhandledRejection=function(a){h(f,a)},a.onPotentiallyUnhandledRejectionHandled=function(a){h(g,a)},a.onFatalRejection=function(a){h(b,a.value)};var m=[],n=[],o=null;return a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/lib/makePromise",[],function(){return function(a){function b(a,b){this._handler=a===t?b:c(a)}function c(a){function b(a){e.resolve(a)}function c(a){e.reject(a)}function d(a){e.notify(a)}var e=new v;try{a(b,c,d)}catch(a){c(a)}return e}function d(a){return I(a)?a:new b(t,new w(q(a)))}function e(a){return new b(t,new w(new z(a)))}function f(){return ba}function g(){return new b(t,new v)}function h(a,b){var c=new v(a.receiver,a.join().context);return new b(t,c)}function i(a){return k(S,null,a)}function j(a,b){return k(N,a,b)}function k(a,c,d){function e(b,e,g){g.resolved||l(d,f,b,a(c,e,b),g)}function f(a,b,c){k[a]=b,0===--j&&c.become(new y(k))}for(var g,h="function"==typeof c?e:f,i=new v,j=d.length>>>0,k=new Array(j),m=0;m<d.length&&!i.resolved;++m)g=d[m],void 0!==g||m in d?l(d,h,m,g,i):--j;return 0===j&&i.become(new y(k)),new b(t,i)}function l(a,b,c,d,e){if(J(d)){var f=r(d),g=f.state();0===g?f.fold(b,c,void 0,e):g>0?b(c,f.value,e):(e.become(f),m(a,c+1,f))}else b(c,d,e)}function m(a,b,c){for(var d=b;d<a.length;++d)n(q(a[d]),c)}function n(a,b){if(a!==b){var c=a.state();0===c?a.visit(a,void 0,a._unreport):c<0&&a._unreport()}}function o(a){return"object"!=typeof a||null===a?e(new TypeError("non-iterable passed to race()")):0===a.length?f():1===a.length?d(a[0]):p(a)}function p(a){var c,d,e,f=new v;for(c=0;c<a.length;++c)if(d=a[c],void 0!==d||c in a){if(e=q(d),0!==e.state()){f.become(e),m(a,c+1,e);break}e.visit(f,f.resolve,f.reject)}return new b(t,f)}function q(a){return I(a)?a._handler.join():J(a)?s(a):new y(a)}function r(a){return I(a)?a._handler.join():s(a)}function s(a){try{var b=a.then;return"function"==typeof b?new x(b,a):new y(a)}catch(a){return new z(a)}}function t(){}function u(){}function v(a,c){b.createContext(this,c),this.consumers=void 0,this.receiver=a,this.handler=void 0,this.resolved=!1}function w(a){this.handler=a}function x(a,b){v.call(this),X.enqueue(new F(a,b,this))}function y(a){b.createContext(this),this.value=a}function z(a){b.createContext(this),this.id=++_,this.value=a,this.handled=!1,this.reported=!1,this._report()}function A(a,b){this.rejection=a,this.context=b}function B(a){this.rejection=a}function C(){return new z(new TypeError("Promise cycle"))}function D(a,b){this.continuation=a,this.handler=b}function E(a,b){this.handler=b,this.value=a}function F(a,b,c){this._then=a,this.thenable=b,this.resolver=c}function G(a,b,c,d,e){try{a.call(b,c,d,e)}catch(a){d(a)}}function H(a,b,c,d){this.f=a,this.z=b,this.c=c,this.to=d,this.resolver=$,this.receiver=this}function I(a){return a instanceof b}function J(a){return("object"==typeof a||"function"==typeof a)&&null!==a}function K(a,c,d,e){return"function"!=typeof a?e.become(c):(b.enterContext(c),O(a,c.value,d,e),void b.exitContext())}function L(a,c,d,e,f){return"function"!=typeof a?f.become(d):(b.enterContext(d),P(a,c,d.value,e,f),void b.exitContext())}function M(a,c,d,e,f){return"function"!=typeof a?f.notify(c):(b.enterContext(d),Q(a,c,e,f),void b.exitContext())}function N(a,b,c){try{return a(b,c)}catch(a){return e(a)}}function O(a,b,c,d){try{d.become(q(a.call(c,b)))}catch(a){d.become(new z(a))}}function P(a,b,c,d,e){try{a.call(d,b,c,e)}catch(a){e.become(new z(a))}}function Q(a,b,c,d){try{d.notify(a.call(c,b))}catch(a){d.notify(a)}}function R(a,b){b.prototype=Z(a.prototype),b.prototype.constructor=b}function S(a,b){return b}function T(){}function U(){if("function"==typeof CustomEvent)try{var a=new CustomEvent("unhandledRejection");return a instanceof CustomEvent}catch(a){}return!1}function V(){if("undefined"!=typeof document&&"function"==typeof document.createEvent)try{var a=document.createEvent("CustomEvent");return a.initCustomEvent("eventType",!1,!0,{}),!0}catch(a){}return!1}function W(){return"undefined"!=typeof process&&null!==process&&"function"==typeof process.emit?function(a,b){return"unhandledRejection"===a?process.emit(a,b.value,b):process.emit(a,b)}:"undefined"!=typeof self&&U()?function(a,b){return function(c,d){var e=new b(c,{detail:{reason:d.value,key:d},bubbles:!1,cancelable:!0});return!a.dispatchEvent(e)}}(self,CustomEvent):"undefined"!=typeof self&&V()?function(a,b){return function(c,d){var e=b.createEvent("CustomEvent");return e.initCustomEvent(c,!1,!0,{reason:d.value,key:d}),!a.dispatchEvent(e)}}(self,document):T}var X=a.scheduler,Y=W(),Z=Object.create||function(a){function b(){}return b.prototype=a,new b};b.resolve=d,b.reject=e,b.never=f,b._defer=g,b._handler=q,b.prototype.then=function(a,b,c){var d=this._handler,e=d.join().state();if("function"!=typeof a&&e>0||"function"!=typeof b&&e<0)return new this.constructor(t,d);var f=this._beget(),g=f._handler;return d.chain(g,d.receiver,a,b,c),f},b.prototype.catch=function(a){return this.then(void 0,a)},b.prototype._beget=function(){return h(this._handler,this.constructor)},b.all=i,b.race=o,b._traverse=j,b._visitRemaining=m,t.prototype.when=t.prototype.become=t.prototype.notify=t.prototype.fail=t.prototype._unreport=t.prototype._report=T,t.prototype._state=0,t.prototype.state=function(){return this._state},t.prototype.join=function(){for(var a=this;void 0!==a.handler;)a=a.handler;return a},t.prototype.chain=function(a,b,c,d,e){this.when({resolver:a,receiver:b,fulfilled:c,rejected:d,progress:e})},t.prototype.visit=function(a,b,c,d){this.chain($,a,b,c,d)},t.prototype.fold=function(a,b,c,d){this.when(new H(a,b,c,d))},R(t,u),u.prototype.become=function(a){a.fail()};var $=new u;R(t,v),v.prototype._state=0,v.prototype.resolve=function(a){this.become(q(a))},v.prototype.reject=function(a){this.resolved||this.become(new z(a))},v.prototype.join=function(){if(!this.resolved)return this;for(var a=this;void 0!==a.handler;)if(a=a.handler,a===this)return this.handler=C();return a},v.prototype.run=function(){var a=this.consumers,b=this.handler;this.handler=this.handler.join(),this.consumers=void 0;for(var c=0;c<a.length;++c)b.when(a[c])},v.prototype.become=function(a){this.resolved||(this.resolved=!0,this.handler=a,void 0!==this.consumers&&X.enqueue(this),void 0!==this.context&&a._report(this.context))},v.prototype.when=function(a){this.resolved?X.enqueue(new D(a,this.handler)):void 0===this.consumers?this.consumers=[a]:this.consumers.push(a)},v.prototype.notify=function(a){this.resolved||X.enqueue(new E(a,this))},v.prototype.fail=function(a){var b="undefined"==typeof a?this.context:a;this.resolved&&this.handler.join().fail(b)},v.prototype._report=function(a){this.resolved&&this.handler.join()._report(a)},v.prototype._unreport=function(){this.resolved&&this.handler.join()._unreport()},R(t,w),w.prototype.when=function(a){X.enqueue(new D(a,this))},w.prototype._report=function(a){this.join()._report(a)},w.prototype._unreport=function(){this.join()._unreport()},R(v,x),R(t,y),y.prototype._state=1,y.prototype.fold=function(a,b,c,d){L(a,b,this,c,d)},y.prototype.when=function(a){K(a.fulfilled,this,a.receiver,a.resolver)};var _=0;R(t,z),z.prototype._state=-1,z.prototype.fold=function(a,b,c,d){d.become(this)},z.prototype.when=function(a){"function"==typeof a.rejected&&this._unreport(),K(a.rejected,this,a.receiver,a.resolver)},z.prototype._report=function(a){X.afterQueue(new A(this,a))},z.prototype._unreport=function(){this.handled||(this.handled=!0,X.afterQueue(new B(this)))},z.prototype.fail=function(a){this.reported=!0,Y("unhandledRejection",this),b.onFatalRejection(this,void 0===a?this.context:a)},A.prototype.run=function(){this.rejection.handled||this.rejection.reported||(this.rejection.reported=!0,Y("unhandledRejection",this.rejection)||b.onPotentiallyUnhandledRejection(this.rejection,this.context))},B.prototype.run=function(){this.rejection.reported&&(Y("rejectionHandled",this.rejection)||b.onPotentiallyUnhandledRejectionHandled(this.rejection))},b.createContext=b.enterContext=b.exitContext=b.onPotentiallyUnhandledRejection=b.onPotentiallyUnhandledRejectionHandled=b.onFatalRejection=T;var aa=new t,ba=new b(t,aa);return D.prototype.run=function(){this.handler.join().when(this.continuation)},E.prototype.run=function(){var a=this.handler.consumers;if(void 0!==a)for(var b,c=0;c<a.length;++c)b=a[c],M(b.progress,this.value,this.handler,b.receiver,b.resolver)},F.prototype.run=function(){function a(a){d.resolve(a)}function b(a){d.reject(a)}function c(a){d.notify(a)}var d=this.resolver;G(this._then,this.thenable,a,b,c)},H.prototype.fulfilled=function(a){this.f.call(this.c,this.z,a,this.to)},H.prototype.rejected=function(a){this.to.reject(a)},H.prototype.progress=function(a){this.to.notify(a)},b}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/Scheduler",[],function(){function a(a){this._async=a,this._running=!1,this._queue=this,this._queueLen=0,this._afterQueue={},this._afterQueueLen=0;var b=this;this.drain=function(){b._drain()}}return a.prototype.enqueue=function(a){this._queue[this._queueLen++]=a,this.run()},a.prototype.afterQueue=function(a){this._afterQueue[this._afterQueueLen++]=a,this.run()},a.prototype.run=function(){this._running||(this._running=!0,this._async(this.drain))},a.prototype._drain=function(){for(var a=0;a<this._queueLen;++a)this._queue[a].run(),this._queue[a]=void 0;for(this._queueLen=0,this._running=!1,a=0;a<this._afterQueueLen;++a)this._afterQueue[a].run(),this._afterQueue[a]=void 0;this._afterQueueLen=0},a})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/lib/Promise",["require","./makePromise","./Scheduler","./env"],function(a){var b=a("./makePromise"),c=a("./Scheduler"),d=a("./env").asap;return b({scheduler:new c(d)})})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/when",["require","./lib/decorators/timed","./lib/decorators/array","./lib/decorators/flow","./lib/decorators/fold","./lib/decorators/inspect","./lib/decorators/iterate","./lib/decorators/progress","./lib/decorators/with","./lib/decorators/unhandledRejection","./lib/TimeoutError","./lib/Promise","./lib/apply"],function(a){function b(a,b,c,d){var e=x.resolve(a);return arguments.length<2?e:e.then(b,c,d)}function c(a){return new x(a)}function d(a){return function(){for(var b=0,c=arguments.length,d=new Array(c);b<c;++b)d[b]=arguments[b];return y(a,this,d)}}function e(a){for(var b=0,c=arguments.length-1,d=new Array(c);b<c;++b)d[b]=arguments[b+1];return y(a,this,d)}function f(){return new g}function g(){function a(a){d._handler.resolve(a)}function b(a){d._handler.reject(a)}function c(a){d._handler.notify(a)}var d=x._defer();this.promise=d,this.resolve=a,this.reject=b,this.notify=c,this.resolver={resolve:a,reject:b,notify:c}}function h(a){return a&&"function"==typeof a.then}function i(){return x.all(arguments)}function j(a){return b(a,x.all)}function k(a){return b(a,x.settle)}function l(a,c){return b(a,function(a){return x.map(a,c)})}function m(a,c){return b(a,function(a){return x.filter(a,c)})}var n=a("./lib/decorators/timed"),o=a("./lib/decorators/array"),p=a("./lib/decorators/flow"),q=a("./lib/decorators/fold"),r=a("./lib/decorators/inspect"),s=a("./lib/decorators/iterate"),t=a("./lib/decorators/progress"),u=a("./lib/decorators/with"),v=a("./lib/decorators/unhandledRejection"),w=a("./lib/TimeoutError"),x=[o,p,q,s,t,r,u,n,v].reduce(function(a,b){return b(a)},a("./lib/Promise")),y=a("./lib/apply")(x);return b.promise=c,b.resolve=x.resolve,b.reject=x.reject,b.lift=d,b.try=e,b.attempt=e,b.iterate=x.iterate,b.unfold=x.unfold,b.join=i,b.all=j,b.settle=k,b.any=d(x.any),b.some=d(x.some),b.race=d(x.race),b.map=l,b.filter=m,b.reduce=d(x.reduce),b.reduceRight=d(x.reduceRight),b.isPromiseLike=h,b.Promise=x,b.defer=f,b.TimeoutError=w,b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/lib/liftAll",[],function(){function a(a,b,c){return a[c]=b,a}function b(a){return"function"==typeof a?a.bind():Object.create(a)}return function(c,d,e,f){return"undefined"==typeof d&&(d=a),Object.keys(f).reduce(function(a,b){var e=f[b];return"function"==typeof e?d(a,c(e),b):a},"undefined"==typeof e?b(f):e)}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){a("when/callbacks",["require","./when","./lib/liftAll","./lib/apply"],function(a){function b(a,b){return q(a,this,b||[])}function c(a,b,c,e){c.push(k(e.resolve,e),k(e.reject,e)),d(a,b,c,e)}function d(a,b,c,d){try{a.apply(b,c)}catch(a){d.reject(a)}}function e(a){return q(a,this,o.call(arguments,1))}function f(a){var b=arguments.length>1?o.call(arguments,1):[];return function(){return q(a,this,b.concat(o.call(arguments)))}}function g(a,b,c){return n(f,b,c,a)}function h(a,b){return function(){var c=this;return m.all(arguments).then(function(d){var e,f,g=m._defer();return"number"==typeof b.callback&&(e=i(d,b.callback)),"number"==typeof b.errback&&(f=i(d,b.errback)),f<e?(j(d,f,g._handler.reject,g._handler),j(d,e,g._handler.resolve,g._handler)):(j(d,e,g._handler.resolve,g._handler),j(d,f,g._handler.reject,g._handler)),a.apply(c,d),g})}}function i(a,b){return b<0?a.length+b+2:b}function j(a,b,c,d){"number"==typeof b&&a.splice(b,0,k(c,d))}function k(a,b){return function(){arguments.length>1?a.call(b,o.call(arguments)):a.apply(b,arguments)}}var l=a("./when"),m=l.Promise,n=a("./lib/liftAll"),o=Array.prototype.slice,p=a("./lib/apply"),q=p(m,c);return{lift:f,liftAll:g,apply:b,call:e,promisify:h}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/cancelable",[],function(){return function(a,b){return a.cancel=function(){try{a.reject(b(a))}catch(b){a.reject(b)}return a.promise},a}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){a("when/delay",["require","./when"],function(a){var b=a("./when");return function(a,c){return b(c).delay(a)}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/function",["require","./when","./lib/liftAll","./lib/apply"],function(a){function b(a,b){return i(a,this,null==b?[]:j.call(b))}function c(a){var b=arguments.length>1?j.call(arguments,1):[];return function(){return i(a,this,b.concat(j.call(arguments)))}}function d(a,b,d){return h(c,b,d,a)}function e(a){var b=j.call(arguments,1);return function(){var c=this,d=j.call(arguments),e=g.apply(c,[a].concat(d));return f.reduce(b,function(a,b){return b.call(c,a)},e)}}var f=a("./when"),g=f.try,h=a("./lib/liftAll"),i=a("./lib/apply")(f.Promise),j=Array.prototype.slice;return{lift:c,liftAll:d,call:g,apply:b,compose:e}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/generator",["require","./when"],function(a){function b(a){return function(){return e(a,this,arguments)}}function c(a){return e(a,this,k.call(arguments,1))}function d(a,b){return e(a,this,b||[])}function e(a,b,c){return f(void 0,a.apply(b,c))}function f(a,b){try{return i(b.next(a),b)}catch(a){return m(a)}}function g(a){return f(a,this)}function h(a){try{return i(this.throw(a),this)}catch(a){return m(a)}}function i(a,b){if(a.done)return a.value;var c=l._handler(a.value);if(c.state()>0)return f(c.value,b);var d=l._defer();return c.chain(d._handler,b,g,h),d}var j=a("./when"),k=Array.prototype.slice,l=j.Promise,m=l.reject;return{lift:b,call:c,apply:d}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/guard",["require","./when"],function(a){function b(a,b){return function(){var c=e.call(arguments);return d(a()).withThis(this).then(function(a){return d(b.apply(this,c)).finally(a)})}}function c(a){function b(){c=Math.max(c-1,0),e.length>0&&e.shift()(b)}var c=0,e=[];return function(){return d.promise(function(d){c<a?d(b):e.push(d),c+=1})}}var d=a("./when"),e=Array.prototype.slice;return b.n=c,b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/keys",["require","./when"],function(a){function b(a){function b(a,b,c){this[a]=b,0===--i&&c.resolve(f)}for(var c,d=g._defer(),e=g._handler(d),f={},h=Object.keys(a),i=h.length,j=0;j<h.length;++j)c=h[j],g._handler(a[c]).fold(b,c,f,e);return 0===i&&e.resolve(f),d}function c(a,c){function d(a,b){return c(b,a)}return h(a).then(function(a){return b(Object.keys(a).reduce(function(b,c){return b[c]=h(a[c]).fold(d,c),b},{}))})}function d(a){var b=Object.keys(a),c={};if(0===b.length)return h(c);var d=g._defer(),i=g._handler(d),j=b.map(function(b){return a[b]});return f.settle(j).then(function(a){e(b,a,c,i)}),d}function e(a,b,c,d){for(var e=0;e<a.length;e++)c[a[e]]=b[e];d.resolve(c)}var f=a("./when"),g=f.Promise,h=f.resolve;return{all:f.lift(b),map:c,settle:d}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/monitor/error",[],function(){function a(a){try{throw new Error}catch(b){a.stack=b.stack}}function b(a){var b=new Error;Object.defineProperty(a,"stack",{get:function(){return b.stack}})}function c(a){a.stack=(new Error).stack}function d(a){return f(a)}function e(a){var b=new Error;return b.stack=d(a),b}function f(a){for(var b=!1,c="",d=0;d<a.length;++d)b?c+="\n"+a[d]:(c+=a[d],b=!0);return c}var g,h,i;return Error.captureStackTrace?(g=function(a){return a&&a.stack&&a.stack.split("\n")},i=d,h=Error.captureStackTrace):(g=function(a){var b=a&&a.stack&&a.stack.split("\n");return b&&a.message&&b.unshift(a.message),b},function(){var f=new Error;"string"!=typeof f.stack?(i=d,h=a):"function"==typeof Object.defineProperty?(i=e,h=b):(i=e,h=c)}()),{parse:g,format:i,captureStack:h}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a()}),function(a){"use strict";a("when/monitor/PromiseMonitor",["require","../lib/env","./error"],function(a){function b(a){this.logDelay=0,this.stackFilter=g,this.stackJumpSeparator=f,this.filterDuplicateFrames=!0,this._reporter=a,"function"==typeof a.configurePromiseMonitor&&a.configurePromiseMonitor(this),this._traces=[],this._traceTask=0;var b=this;this._doLogTraces=function(){b._logTraces()}}function c(a,b,c){b.length>1&&(b[0]=c,a.push.apply(a,b))}function d(a,b){return b.filter(function(b){return!a.test(b)})}function e(a){return!a.handler.handled}var f="from execution context:",g=/[\s\(\/\\](node|module|timers)\.js:|when([\/\\]{1,2}(lib|monitor|es6-shim)[\/\\]{1,2}|\.js)|(new\sPromise)\b|(\b(PromiseMonitor|ConsoleReporter|Scheduler|RunHandlerTask|ProgressTask|Promise|.*Handler)\.[\w_]\w\w+\b)|\b(tryCatch\w+|getHandler\w*|useStackDirectly|useStackLazily|captureSpiderMonkeyStack)\b/i,h=a("../lib/env").setTimer,i=a("./error"),j=[];return b.prototype.monitor=function(a){var b=this;return a.createContext=function(a,c){a.context=b.createContext(a,c)},a.enterContext=function(a){j.push(a.context)},a.exitContext=function(){j.pop()},a.onPotentiallyUnhandledRejection=function(a,c){return b.addTrace(a,c)},a.onPotentiallyUnhandledRejectionHandled=function(a){return b.removeTrace(a)},a.onFatalRejection=function(a,c){return b.fatal(a,c)},this},b.prototype.createContext=function(a,b){var c={parent:b||j[j.length-1],stack:void 0};return i.captureStack(c,a.constructor),c},b.prototype.addTrace=function(a,b){var c,d;for(d=this._traces.length-1;d>=0&&(c=this._traces[d],c.handler!==a);--d);d>=0?c.extraContext=b:this._traces.push({handler:a,extraContext:b}),this.logTraces()},b.prototype.removeTrace=function(){this.logTraces()},b.prototype.fatal=function(a,b){var c=new Error;c.stack=this._createLongTrace(a.value,a.context,b).join("\n"),h(function(){throw c},0)},b.prototype.logTraces=function(){this._traceTask||(this._traceTask=h(this._doLogTraces,this.logDelay))},b.prototype._logTraces=function(){this._traceTask=void 0,this._traces=this._traces.filter(e),this._reporter.log(this.formatTraces(this._traces))},b.prototype.formatTraces=function(a){return a.map(function(a){return this._createLongTrace(a.handler.value,a.handler.context,a.extraContext)},this)},b.prototype._createLongTrace=function(a,b,c){var e=i.parse(a)||[String(a)+" (WARNING: non-Error used)"];return e=d(this.stackFilter,e,0),this._appendContext(e,b),this._appendContext(e,c),this.filterDuplicateFrames?this._removeDuplicates(e):e},b.prototype._removeDuplicates=function(a){var b={},c=this.stackJumpSeparator,d=0;return a.reduceRight(function(a,e,f){return 0===f?a.unshift(e):e===c?d>0&&(a.unshift(e),d=0):b[e]||(b[e]=!0,a.unshift(e),++d),a},[])},b.prototype._appendContext=function(a,b){a.push.apply(a,this._createTrace(b))},b.prototype._createTrace=function(a){for(var b,e=[];a;)b=i.parse(a),b&&(b=d(this.stackFilter,b),c(e,b,this.stackJumpSeparator)),a=a.parent;return e},b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/monitor/ConsoleReporter",["require","./error"],function(a){function b(){this._previouslyReported=!1}function c(){var a,b,c,e;if("undefined"==typeof console)a=b=d;else{var f=console;"function"==typeof f.error&&"function"==typeof f.dir?(b=function(a){f.error(a)},a=function(a){f.log(a)},"function"==typeof f.groupCollapsed&&(c=function(a){f.groupCollapsed(a)},e=function(){f.groupEnd()})):a=b="undefined"!=typeof f.log&&"undefined"!=typeof JSON?function(a){if("string"!=typeof a)try{a=JSON.stringify(a)}catch(a){}f.log(a)}:d}return{msg:a,warn:b,groupStart:c||b,groupEnd:e||d}}function d(){}var e=a("./error"),f="[promises] Unhandled rejections: ",g="[promises] All previously unhandled rejections have now been handled";return b.prototype=c(),b.prototype.log=function(a){if(0===a.length)return void(this._previouslyReported&&(this._previouslyReported=!1,this.msg(g)));this._previouslyReported=!0,this.groupStart(f+a.length);try{this._log(a)}finally{this.groupEnd()}},b.prototype._log=function(a){for(var b=0;b<a.length;++b)this.warn(e.format(a[b]))},b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/monitor",["require","./monitor/PromiseMonitor","./monitor/ConsoleReporter"],function(a){var b=a("./monitor/PromiseMonitor"),c=a("./monitor/ConsoleReporter"),d=new b(new c);return function(a){return d.monitor(a)}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require);
}),function(a){a("when/node",["require","./when","./lib/liftAll","./lib/env","./lib/apply"],function(a){function b(a,b){return n(a,this,b||[])}function c(a,b,c,d){var e=g(d);try{switch(c.length){case 2:a.call(b,c[0],c[1],e);break;case 1:a.call(b,c[0],e);break;case 0:a.call(b,e);break;default:c.push(e),a.apply(b,c)}}catch(a){d.reject(a)}}function d(a){return n(a,this,m.call(arguments,1))}function e(a){var b=arguments.length>1?m.call(arguments,1):[];return function(){var c,d=b.length,e=arguments.length,f=new Array(e+d);for(c=0;c<d;++c)f[c]=b[c];for(c=0;c<e;++c)f[c+d]=arguments[c];return n(a,this,f)}}function f(a,b,c){return k(e,b,c,a)}function g(a){return function(b,c){b?a.reject(b):arguments.length>2?a.resolve(m.call(arguments,1)):a.resolve(c)}}function h(a,b){function c(a){d(null,a)}function d(a,c){l(function(){b(a,c)},0)}return a=j(a),b&&a.then(c,d),a}function i(a){return function(b){return h(b,a)}}var j=a("./when"),k=a("./lib/liftAll"),l=a("./lib/env").setTimer,m=Array.prototype.slice,n=a("./lib/apply")(j.Promise,c);return{lift:e,liftAll:f,apply:b,call:d,createCallback:g,bindCallback:h,liftCallback:i}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/parallel",["require","./when"],function(a){var b=a("./when"),c=b.Promise.all,d=Array.prototype.slice;return function(a){return c(d.call(arguments,1)).then(function(c){return b.map(a,function(a){return a.apply(void 0,c)})})}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/pipeline",["require","./when"],function(a){var b=a("./when"),c=b.Promise.all,d=Array.prototype.slice;return function(a){var e=function(a,b){return e=function(a,b){return b(a)},b.apply(null,a)};return c(d.call(arguments,1)).then(function(c){return b.reduce(a,function(a,b){return e(a,b)},c)})}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/poll",["require","./when","./cancelable"],function(a){var b=a("./when"),c=b.try,d=a("./cancelable");return function(a,e,f,g){function h(a){k.resolve(a)}function i(a){c(e).then(j,m),void 0!==a&&k.notify(a)}function j(){l||b(a(),function(a){b(f(a),function(b){return b?h(a):i(a)},function(){i(a)})},m)}var k,l,m;return l=!1,k=d(b.defer(),function(){l=!0}),m=k.reject,f=f||function(){return!1},"function"!=typeof e&&(e=function(a){return function(){return b().delay(a)}}(e)),g?i():j(),k.promise=Object.create(k.promise),k.promise.cancel=k.cancel,k.promise}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/sequence",["require","./when"],function(a){var b=a("./when"),c=b.Promise.all,d=Array.prototype.slice;return function(a){function e(a){return f.push(a),f}var f=[];return c(d.call(arguments,1)).then(function(c){return b.reduce(a,function(a,d){return b(d.apply(void 0,c),e)},f)})}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/timeout",["require","./when"],function(a){var b=a("./when");return function(a,c){return b(c).timeout(a)}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/unfold",["require","./when"],function(a){return a("./when").unfold})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/node/function",["require","../node"],function(a){return a("../node")})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("when/unfold/list",["require","../when"],function(a){var b=a("../when").unfold;return function(a,c,d){function e(a,b){return f.push(a),b}var f=[];return b(a,c,e,d).yield(f)}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("when/monitor/console",["require","../monitor","../when"],function(a){var b=a("../monitor"),c=a("../when").Promise;return b(c)})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),define(["when/when"],function(a){return a});