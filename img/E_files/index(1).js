!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.B2BFeAuth=t():e.B2BFeAuth=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";var r=n(21)();e.exports=function(e){return e!==r&&null!==e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRedirectURL=t.redirectToLogin=t.getHashParameter=t.ACCESS_TOKEN_KEY=t.SCHOOL_ID_KEY=void 0;var r,o=n(2),i=(r=o)&&r.__esModule?r:{default:r};t.SCHOOL_ID_KEY="school_id",t.ACCESS_TOKEN_KEY="access_token",t.getHashParameter=function(e){var t=e.replace(/[\[\]]/g,"\\$&"),n=new RegExp("[#&]"+t+"(=([^&#]*)|&|#|$)").exec(window.location.href);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},t.redirectToLogin=function(e){var t=s(e);window.location.href=t};var s=t.getRedirectURL=function(e){var t=i.default.oAuth,n=e.oAuth,r=n.providers||t.providers,o=n.responseType,s=n.clientId,a=n.scope,u=n.redirectUri,c=n.endpoint,f=n.state,l=o||t.responseType,d=s||t.clientId,p=a||t.scope,h=u||t.redirectUri,y=(y||t.providers,[]);for(var v in r)r.hasOwnProperty(v)&&r[v]&&y.push(v);var m=[["response_type",encodeURIComponent(l)].join("="),["client_id",encodeURIComponent(d)].join("="),["scope",encodeURIComponent(p)].join("="),["redirect_uri",encodeURIComponent(h)].join("="),["providers",encodeURIComponent(y.join(","))].join("=")];return f&&m.push(["state",encodeURIComponent(f)].join("=")),c+"?"+m.join("&")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={oAuth:{endpoint:"/oauth2/auth",responseType:"token",clientId:"platform-client",providers:{facebook:!0,google:!0,linkedin:!0,wechat:!0},scope:"",state:"",redirectUri:window.location.href,accessTokenParam:"access_token",idTokenParam:"id_token",logout:{endpoint:"/oauth2/v1/logout",redirectUri:window.location.href}},account:{endpoint:"/2/api/account/v1/accounts",schoolId:"",jwtHeader:"X-EF-ACCESS",refreshInterval:18e5},queryproxy:{endpoint:"/2/api/school-proxy/v1/troop"},storage:{key:"efid_tokens"},autoStart:!1,autoRedirect:!1,prioritizeTokensFromHash:!1,keepTokensInHash:!1,domLogout:"platform-auth.logout",b2bAuth:{endpoint:"/2/api/b2b-member/students"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(33),i=(r=o)&&r.__esModule?r:{default:r};t.default={get:function(e){return i.default.get(e)},set:function(e,t){return i.default.set(e,t,{path:"/"})},remove:function(e){return i.default.remove(e,{path:"/"})}}},function(e,t,n){n(5),n(9),n(10),e.exports=n(30)},function(e,t,n){"use strict";e.exports=n(6).polyfill()},function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.6+9869a4bc
 */var r;r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,s=void 0,a=function(e,t){h[o]=e,h[o+1]=t,2===(o+=2)&&(s?s(y):b())},u="undefined"!=typeof window?window:void 0,c=u||{},f=c.MutationObserver||c.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(y,1)}}var h=new Array(1e3);function y(){for(var e=0;e<o;e+=2){(0,h[e])(h[e+1]),h[e]=void 0,h[e+1]=void 0}o=0}var v,m,g,_,b=void 0;function w(e,t){var n=this,r=new this.constructor(E);void 0===r[C]&&N(r);var o=n._state;if(o){var i=arguments[o-1];a(function(){return L(o,r,i,n._result)})}else U(n,r,e,t);return r}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(E);return k(t,e),t}l?b=function(){return t.nextTick(y)}:f?(m=0,g=new f(y),_=document.createTextNode(""),g.observe(_,{characterData:!0}),b=function(){_.data=m=++m%2}):d?((v=new MessageChannel).port1.onmessage=y,b=function(){return v.port2.postMessage(0)}):b=void 0===u?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(y)}:p()}catch(e){return p()}}():p();var C=Math.random().toString(36).substring(2);function E(){}var I=void 0,O=1,A=2,S={error:null};function x(e){try{return e.then}catch(e){return S.error=e,S}}function j(t,n,r){n.constructor===t.constructor&&r===w&&n.constructor.resolve===T?function(e,t){t._state===O?R(e,t._result):t._state===A?F(e,t._result):U(t,void 0,function(t){return k(e,t)},function(t){return F(e,t)})}(t,n):r===S?(F(t,S.error),S.error=null):void 0===r?R(t,n):e(r)?function(e,t,n){a(function(e){var r=!1,o=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?k(e,n):R(e,n))},function(t){r||(r=!0,F(e,t))},e._label);!r&&o&&(r=!0,F(e,o))},e)}(t,n,r):R(t,n)}function k(e,t){var n,r;e===t?F(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?R(e,t):j(e,t,x(t)))}function P(e){e._onerror&&e._onerror(e._result),M(e)}function R(e,t){e._state===I&&(e._result=t,e._state=O,0!==e._subscribers.length&&a(M,e))}function F(e,t){e._state===I&&(e._state=A,e._result=t,a(P,e))}function U(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+O]=n,o[i+A]=r,0===i&&e._state&&a(M,e)}function M(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?L(n,r,o,i):o(i);e._subscribers.length=0}}function L(t,n,r,o){var i=e(r),s=void 0,a=void 0,u=void 0,c=void 0;if(i){if((s=function(e,t){try{return e(t)}catch(e){return S.error=e,S}}(r,o))===S?(c=!0,a=s.error,s.error=null):u=!0,n===s)return void F(n,new TypeError("A promises callback cannot return that same promise."))}else s=o,u=!0;n._state!==I||(i&&u?k(n,s):c?F(n,a):t===O?R(n,s):t===A&&F(n,s))}var D=0;function N(e){e[C]=D++,e._state=void 0,e._result=void 0,e._subscribers=[]}var B=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(E),this.promise[C]||N(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&R(this.promise,this._result))):F(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===I&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===T){var o=x(e);if(o===w&&e._state!==I)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===J){var i=new n(E);j(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===I&&(this._remaining--,e===A?F(r,n):this._result[t]=n),0===this._remaining&&R(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;U(e,void 0,function(e){return n._settledAt(O,t,e)},function(e){return n._settledAt(A,t,e)})},e}(),J=function(){function t(e){this[C]=D++,this._result=this._state=void 0,this._subscribers=[],E!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t(function(t){k(e,t)},function(t){F(e,t)})}catch(t){F(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})}):this.then(t,t)},t}();return J.prototype.then=w,J.all=function(e){return new B(this,e).promise},J.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},J.resolve=T,J.reject=function(e){var t=new this(E);return F(t,e),t},J._setScheduler=function(e){s=e},J._setAsap=function(e){a=e},J._asap=a,J.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=J},J.Promise=J,J},e.exports=r()}).call(this,n(7),n(8))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],f=!1,l=-1;function d(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&p())}function p(){if(!f){var e=a(d);f=!0;for(var t=c.length;t;){for(u=c,c=[];++l<t;)u&&u[l].run();l=-1,t=c.length}u=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||f||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},o=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};f.prototype.append=function(e,t){e=a(e),t=u(t);var n=this.map[e];this.map[e]=n?n+","+t:t},f.prototype.delete=function(e){delete this.map[a(e)]},f.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},f.prototype.set=function(e,t){this.map[a(e)]=u(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),c(e)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),c(e)},f.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),c(e)},t.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];v.prototype.clone=function(){return new v(this,{body:this._bodyInit})},y.call(v.prototype),y.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:0,statusText:""});return e.type="error",e};var s=[301,302,303,307,308];g.redirect=function(e,t){if(-1===s.indexOf(t))throw new RangeError("Invalid status code");return new g(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=v,e.Response=g,e.fetch=function(e,n){return new Promise(function(r,o){var i=new v(e,n),s=new XMLHttpRequest;s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;r(new g(o,n))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&t.blob&&(s.responseType="blob"),i.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function c(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function f(e){this.map={},e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function p(e){var t=new FileReader,n=d(t);return t.readAsArrayBuffer(e),n}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e))this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!o(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var e,t,n,r=l(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=d(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function v(e,t){var n,r,o=(t=t||{}).body;if(e instanceof v){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),i.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function g(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},function(e,t,n){"use strict";n(11)()||Object.defineProperty(n(12),"Symbol",{value:n(13),configurable:!0,enumerable:!1,writable:!0})},function(e,t,n){"use strict";var r={object:!0,symbol:!0};e.exports=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return!!r[typeof Symbol.iterator]&&(!!r[typeof Symbol.toPrimitive]&&!!r[typeof Symbol.toStringTag])}},function(e,t){e.exports=function(){return this}()},function(e,t,n){"use strict";var r,o,i,s,a=n(14),u=n(28),c=Object.create,f=Object.defineProperties,l=Object.defineProperty,d=Object.prototype,p=c(null);if("function"==typeof Symbol){r=Symbol;try{String(r()),s=!0}catch(e){}}var h,y=(h=c(null),function(e){for(var t,n,r=0;h[e+(r||"")];)++r;return h[e+=r||""]=!0,l(d,t="@@"+e,a.gs(null,function(e){n||(n=!0,l(this,t,a(e)),n=!1)})),t});i=function(e){if(this instanceof i)throw new TypeError("Symbol is not a constructor");return o(e)},e.exports=o=function e(t){var n;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return s?r(t):(n=c(i.prototype),t=void 0===t?"":String(t),f(n,{__description__:a("",t),__name__:a("",y(t))}))},f(o,{for:a(function(e){return p[e]?p[e]:p[e]=o(String(e))}),keyFor:a(function(e){var t;for(t in u(e),p)if(p[t]===e)return t}),hasInstance:a("",r&&r.hasInstance||o("hasInstance")),isConcatSpreadable:a("",r&&r.isConcatSpreadable||o("isConcatSpreadable")),iterator:a("",r&&r.iterator||o("iterator")),match:a("",r&&r.match||o("match")),replace:a("",r&&r.replace||o("replace")),search:a("",r&&r.search||o("search")),species:a("",r&&r.species||o("species")),split:a("",r&&r.split||o("split")),toPrimitive:a("",r&&r.toPrimitive||o("toPrimitive")),toStringTag:a("",r&&r.toStringTag||o("toStringTag")),unscopables:a("",r&&r.unscopables||o("unscopables"))}),f(i.prototype,{constructor:a(o),toString:a("",function(){return this.__name__})}),f(o.prototype,{toString:a(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:a(function(){return u(this)})}),l(o.prototype,o.toPrimitive,a("",function(){var e=u(this);return"symbol"==typeof e?e:e.toString()})),l(o.prototype,o.toStringTag,a("c","Symbol")),l(i.prototype,o.toStringTag,a("c",o.prototype[o.toStringTag])),l(i.prototype,o.toPrimitive,a("c",o.prototype[o.toPrimitive]))},function(e,t,n){"use strict";var r=n(15),o=n(23),i=n(24),s=n(25);(e.exports=function(e,t){var n,i,a,u,c;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],null==e?(n=a=!0,i=!1):(n=s.call(e,"c"),i=s.call(e,"e"),a=s.call(e,"w")),c={value:t,configurable:n,enumerable:i,writable:a},u?r(o(u),c):c}).gs=function(e,t,n){var a,u,c,f;return"string"!=typeof e?(c=n,n=t,t=e,e=null):c=arguments[3],null==t?t=void 0:i(t)?null==n?n=void 0:i(n)||(c=n,n=void 0):(c=t,t=n=void 0),null==e?(a=!0,u=!1):(a=s.call(e,"c"),u=s.call(e,"e")),f={get:t,set:n,configurable:a,enumerable:u},c?r(o(c),f):f}},function(e,t,n){"use strict";e.exports=n(16)()?Object.assign:n(17)},function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(18),o=n(22),i=Math.max;e.exports=function(e,t){var n,s,a,u=i(arguments.length,2);for(e=Object(o(e)),a=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},s=1;s<u;++s)t=arguments[s],r(t).forEach(a);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(19)()?Object.keys:n(20)},function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(0),o=Object.keys;e.exports=function(e){return o(r(e)?Object(e):e)}},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,n){"use strict";var r=n(0),o=Array.prototype.forEach,i=Object.create;e.exports=function(e){var t=i(null);return o.call(arguments,function(e){r(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t}},function(e,t,n){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,t,n){"use strict";e.exports=n(26)()?String.prototype.contains:n(27)},function(e,t,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&(!0===r.contains("dwa")&&!1===r.contains("foo"))}},function(e,t,n){"use strict";var r=String.prototype.indexOf;e.exports=function(e){return r.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";var r=n(29);e.exports=function(e){if(!r(e))throw new TypeError(e+" is not a symbol");return e}},function(e,t,n){"use strict";e.exports=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&("Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag]))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=c(n(31)),i=n(1),s=n(32),a=n(34),u=c(n(2));function c(e){return e&&e.__esModule?e:{default:e}}t.default={getPlatformAuth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{key:i.SCHOOL_ID_KEY,endpoint:"/2/api/b2b-member/students",specifiedSchoolID:""},n=r({},u.default,e);return new Promise(function(e,r){var u=n.b2bAuth||{},c=u.key||t.key,f=u.endpoint||t.endpoint,l=u.specifiedSchoolID||t.specifiedSchoolID;if(l){(0,a.saveSchoolID)(c,l);var d=(0,a.getConfig)(n,l);e(new o.default(d))}else{var p=(0,s.getAccessToken)(n);if(p)fetch(f,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+p}}).then(function(e){if(200===e.status)return e.json();(0,i.redirectToLogin)(n)}).then(function(t){var r=void 0;if(t.students&&(r=t.students.length>0&&t.students[0].schoolId),r){(0,a.saveSchoolID)(c,r);var s=(0,a.getConfig)(n,r);e(new o.default(s))}else(0,i.redirectToLogin)(n)}).catch(function(e){(0,i.redirectToLogin)(n)});else{var h=(0,a.getSchoolIDFromLocal)(c);if(h){var y=(0,a.getConfig)(n,h);e(new o.default(y))}else(0,i.redirectToLogin)(n)}}})}}},function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(e,t,n){(function(r){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(30)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(t,n(29))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={NETWORK_FAILURE:Symbol("network failure"),VALIDATE_ACCESS_TOKEN:{QUERY_PROXY_FAILURE:Symbol("query proxy failed"),QUERY_PROXY_EMPTY_RESPONSE:Symbol("query proxy empty response")},VALIDATE_ACCOUNT_JWT:{EXPIRED:Symbol("account JWT expired"),MISSING_EXPIRATION_TIME:Symbol("account JWT missing expiration time"),INVALID:Symbol("account JWT invalid")},RETRIEVE_ACCOUNT_TOKEN:{ACCOUNT_SERVICE_FAILURE:Symbol("account service failed")},RETRIEVE_EFID_TOKENS:{MISSING_TOKENS:Symbol("missing efid tokens in url hash")},RETRIEVE_STORED_TOKENS:{INVALID:Symbol("cannot parse stored tokens data"),MISSING:Symbol("tokens missing in storage")},GET_JWT_EXPIRATION_TIME:{MISSING_EXPIRATION_TIME:Symbol("JWT missing expiration time"),INVALID:Symbol("JWT invalid")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce(function(e,n){return e[n]=t[n],e},new Error(e))}},function(e,t,n){"use strict";var r=n(17)();e.exports=function(e){return e!==r&&null!==e}},function(e,t,n){"use strict";function r(e){this.message=e}var o=n(27);r.prototype=new Error,r.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[n]))}catch(e){throw new r("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(32),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={get:function(e){return o.default.get(e)},set:function(e,t){return o.default.set(e,t,{path:"/"})},remove:function(e){return o.default.remove(e,{path:"/"})}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=r(o),s=n(2),a=r(s),u=n(1),c=r(u);t.default=function(e){return new Promise(function(t,n){var r;try{r=(0,i.default)(e)}catch(e){return n((0,a.default)("invalid jwt",{type:c.default.GET_JWT_EXPIRATION_TIME.INVALID}))}r.exp?t(1e3*r.exp):n((0,a.default)("Expiration time missing",{type:c.default.GET_JWT_EXPIRATION_TIME.MISSING_EXPIRATION_TIME}))})}},function(e,t,n){e.exports=n(8)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(this instanceof o))return new o(t);this.params=(0,u.default)(v.default,t),N("constructing a new TokensEmitter with params: %O",this.params),this.params.autoStart&&this.start(),this.params.autoRedirect&&this.on("redirect",function(e){N("auto redirecting to %s",e),window.location=e}),this.params.domLogout&&document.addEventListener(this.params.domLogout,function(){return e.logout()})}var i=n(9),s=r(i),a=n(25),u=r(a),c=n(26),f=r(c),l=n(0),d=r(l),p=n(5),h=r(p),y=n(33),v=r(y),m=n(34),g=r(m),_=n(35),b=r(_),w=n(36),T=r(w),C=n(6),E=r(C),I=n(38),O=r(I),A=n(41),S=r(A),x=n(42),j=r(x),k=n(43),P=r(k),R=n(44),F=r(R),U=n(45),M=r(U),L=n(1),D=r(L),N=(0,d.default)("platform-fe-auth");N("default params: %O",v.default);var B=function(e){return N("trying to retrieve stored tokens..."),(0,g.default)(e).then(function(t){return N("trying to validate stored tokens..."),(0,O.default)(e,t).then(function(){return t})}).catch(function(t){throw N("failed to retrieve/validate stored tokens. %s",t),t.type!==D.default.NETWORK_FAILURE&&h.default.remove(e.storage.key),t})};(0,s.default)(o.prototype),o.prototype.getEventPromise=function(e){var t=this;return new Promise(function(n,r){function o(e){t.off("error",i),n(e)}function i(n){t.off(e,o),r(n)}t.once(e,o),t.once("error",i)})},o.prototype.start=function(){var e=this;if(this._tStart)N("start() called after already started. ignoring.");else{var t=!1,n=this.params,r=function(n){return N("retrieving EFID tokens..."),(0,T.default)(n).then(function(r){return t=!0,e.emit("efid",{access:r.access,id:r.id},{id:n.oAuth.idTokenParam?(0,f.default)(r.id):void 0}),N("retrieving EF account JWT..."),(0,b.default)(n,r.access).then(function(e){return{access:r.access,id:r.id,account:e}})})};N("starting"),F.default.start(),this._tStart=(0,M.default)(0).then(function(){return n.prioritizeTokensFromHash?r(n).catch(function(){return B(n)}):B(n).catch(function(){return r(n)})}).then(function(r){var o=function(t){N("refreshing account JWT..."),(0,b.default)(n,t.access).then(function(e){return{access:t.access,id:t.id,account:e}}).then(i).catch(function(t){N("failed to retrieve account JWT: %s",t),e.emit("error",t)})},i=function(t){N("tokens retrieved successfully: %O",t);var r={id:n.oAuth.idTokenParam?(0,f.default)(t.id):void 0,account:(0,f.default)(t.account)};N("JWT payloads: %O",r),h.default.set(n.storage.key,JSON.stringify(t)),function(e){N("scheduling next refresh with %dms timeout",n.account.refreshInterval),setTimeout(function(){o(e)},n.account.refreshInterval)}(t),e.emit("tokens",t,r)};return t&&!n.keepTokensInHash&&(0,P.default)(n.oAuth.accessTokenParam,n.oAuth.idTokenParam),r.imp_account&&(r.account=r.imp_account),(0,E.default)(r.account).then(function(t){r.imp_account?t<=Date.now()?(N("account JWT has expired, going to login redirect"),e.emit("redirect",(0,S.default)(n))):(N("unexpired impersonation token found, emitting immediately"),e.emit("tokens",r)):t<=Date.now()+n.account.refreshInterval?(N("account JWT will expire before next refresh. refreshing now."),o(r)):i(r)}).catch(function(t){N("failed to get JWT expiration time: %s",t),e.emit("error",t)})}).catch(function(r){return t?(N("failed to retrieve tokens for unknown error: %s",r),void e.emit("error",r)):F.default.isDeparting()?(N("abort due to user leaving the page"),void e.emit("error",r)):(N("failed to retrieve tokens. redirect to EFID is needed."),void e.emit("redirect",(0,S.default)(n)))})}},o.prototype.logout=function(){var e=this,t=this.params;N("logging out"),this._tLogout=(0,M.default)(0).then(function(){N("trying to retrieve stored tokens..."),(0,g.default)(t).then(function(n){N("clearing tokens from storage"),h.default.remove(t.storage.key),N("redirect to logout URL needed"),e.emit("redirect",(0,j.default)(t,n.access))}).catch(function(t){N("unable to retrieve tokens from storage. can't log out."),e.emit("error",t)})})},o.ERRORS=D.default,e.exports=o},function(e,t,n){"use strict";var r,o,i,s,a,u,c,f=n(10),l=n(24),d=Function.prototype.apply,p=Function.prototype.call,h=Object.create,y=Object.defineProperty,v=Object.defineProperties,m=Object.prototype.hasOwnProperty,g={configurable:!0,enumerable:!1,writable:!0};o=function(e,t){var n,o;return l(t),o=this,r.call(this,e,n=function(){i.call(o,e,n),d.call(t,this,arguments)}),n.__eeOnceListener__=t,this},i=function(e,t){var n,r,o,i;if(l(t),!m.call(this,"__ee__"))return this;if(!(n=this.__ee__)[e])return this;if("object"==typeof(r=n[e]))for(i=0;o=r[i];++i)o!==t&&o.__eeOnceListener__!==t||(2===r.length?n[e]=r[i?0:1]:r.splice(i,1));else r!==t&&r.__eeOnceListener__!==t||delete n[e];return this},s=function(e){var t,n,r,o,i;if(m.call(this,"__ee__")&&(o=this.__ee__[e]))if("object"==typeof o){for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];for(o=o.slice(),t=0;r=o[t];++t)d.call(r,this,i)}else switch(arguments.length){case 1:p.call(o,this);break;case 2:p.call(o,this,arguments[1]);break;case 3:p.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,i=new Array(n-1),t=1;t<n;++t)i[t-1]=arguments[t];d.call(o,this,i)}},a={on:r=function(e,t){var n;return l(t),m.call(this,"__ee__")?n=this.__ee__:(n=g.value=h(null),y(this,"__ee__",g),g.value=null),n[e]?"object"==typeof n[e]?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},once:o,off:i,emit:s},u={on:f(r),once:f(o),off:f(i),emit:f(s)},c=v({},u),e.exports=t=function(e){return null==e?h(c):v(Object(e),u)},t.methods=a},function(e,t,n){"use strict";var r=n(11),o=n(19),i=n(20),s=n(21);(e.exports=function(e,t){var n,i,a,u,c;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],null==e?(n=a=!0,i=!1):(n=s.call(e,"c"),i=s.call(e,"e"),a=s.call(e,"w")),c={value:t,configurable:n,enumerable:i,writable:a},u?r(o(u),c):c}).gs=function(e,t,n){var a,u,c,f;return"string"!=typeof e?(c=n,n=t,t=e,e=null):c=arguments[3],null==t?t=void 0:i(t)?null==n?n=void 0:i(n)||(c=n,n=void 0):(c=t,t=n=void 0),null==e?(a=!0,u=!1):(a=s.call(e,"c"),u=s.call(e,"e")),f={get:t,set:n,configurable:a,enumerable:u},c?r(o(c),f):f}},function(e,t,n){"use strict";e.exports=n(12)()?Object.assign:n(13)},function(e,t,n){"use strict";e.exports=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,t,n){"use strict";var r=n(14),o=n(18),i=Math.max;e.exports=function(e,t){var n,s,a,u=i(arguments.length,2);for(e=Object(o(e)),a=function(r){try{e[r]=t[r]}catch(e){n||(n=e)}},s=1;s<u;++s)t=arguments[s],r(t).forEach(a);if(void 0!==n)throw n;return e}},function(e,t,n){"use strict";e.exports=n(15)()?Object.keys:n(16)},function(e,t,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(3),o=Object.keys;e.exports=function(e){return o(r(e)?Object(e):e)}},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";var r=n(3);e.exports=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e}},function(e,t,n){"use strict";var r=n(3),o=Array.prototype.forEach,i=Object.create;e.exports=function(e){var t=i(null);return o.call(arguments,function(e){r(e)&&function(e,t){var n;for(n in e)t[n]=e[n]}(Object(e),t)}),t}},function(e,t,n){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,t,n){"use strict";e.exports=n(22)()?String.prototype.contains:n(23)},function(e,t,n){"use strict";var r="razdwatrzy";e.exports=function(){return"function"==typeof r.contains&&!0===r.contains("dwa")&&!1===r.contains("foo")}},function(e,t,n){"use strict";var r=String.prototype.indexOf;e.exports=function(e){return r.call(this,e,arguments[1])>-1}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,t,n){"use strict";function r(e,t){return t&&!0===t.clone&&s(e)?i(function(e){return Array.isArray(e)?[]:{}}(e),e,t):e}function o(e,t,n){var o=e.slice();return t.forEach(function(t,a){void 0===o[a]?o[a]=r(t,n):s(t)?o[a]=i(e[a],t,n):-1===e.indexOf(t)&&o.push(r(t,n))}),o}function i(e,t,n){var a=Array.isArray(t),u=Array.isArray(e),c=n||{arrayMerge:o};return a===u?a?(c.arrayMerge||o)(e,t,n):function(e,t,n){var o={};return s(e)&&Object.keys(e).forEach(function(t){o[t]=r(e[t],n)}),Object.keys(t).forEach(function(a){s(t[a])&&e[a]?o[a]=i(e[a],t[a],n):o[a]=r(t[a],n)}),o}(e,t,n):r(t,n)}var s=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"!==t&&"[object Date]"!==t}(e)};i.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,n){return i(e,n,t)})};var a=i;e.exports=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=r(o),s=n(0),a=r(s),u=(0,a.default)("platform-fe-auth:utils:tryJwtDecode");t.default=function(e){try{return(0,i.default)(e)}catch(t){return void u("Warning: unable to parse JWT %s",e)}}},function(e,t,n){var r=n(28);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(r(e).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}(t)}catch(e){return r(t)}}},function(e,t){function n(e){this.message=e}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,i,s=0,a=0,u="";i=t.charAt(a++);~i&&(o=s%4?64*o+i:i,s++%4)?u+=String.fromCharCode(255&o>>(-2*s&6)):0)i=r.indexOf(i);return u}},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(){h&&d&&(h=!1,d.length?p=d.concat(p):y=-1,p.length&&s())}function s(){if(!h){var e=o(i);h=!0;for(var t=p.length;t;){for(d=p,p=[];++y<t;)d&&d[y].run();y=-1,t=p.length}d=null,h=!1,function(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function u(){}var c,f,l=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var d,p=[],h=!1,y=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new a(e,t)),1!==p.length||h||o(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=u,l.addListener=u,l.once=u,l.off=u,l.removeListener=u,l.removeAllListeners=u,l.emit=u,l.prependListener=u,l.prependOnceListener=u,l.listeners=function(e){return[]},l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(e,t,n){function r(e){function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;u++;var o=t.formatters[r];if("function"==typeof o){var i=s[u];n=o.call(e,i),s.splice(u,1),u--}return n}),t.formatArgs.call(e,s),(n.log||t.log||console.log.bind(console)).apply(e,s)}}var r;return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),n.destroy=o,"function"==typeof t.init&&t.init(n),t.instances.push(n),n}function o(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];var n,r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(31),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){return r(e,a,"day")||r(e,s,"hour")||r(e,i,"minute")||r(e,o,"second")||e+" ms"}function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var o=1e3,i=60*o,s=60*i,a=24*s,u=365.25*a;e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*u;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*s;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===r&&!1===isNaN(e))return t.long?n(e):function(e){return e>=a?Math.round(e/a)+"d":e>=s?Math.round(e/s)+"h":e>=i?Math.round(e/i)+"m":e>=o?Math.round(e/o)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var r,o,i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}return function t(n){function r(t,o,i){var s;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}i.expires=i.expires?i.expires.toUTCString():"";try{s=JSON.stringify(o),/^[\{\[]/.test(s)&&(o=s)}catch(e){}o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var u="";for(var c in i)i[c]&&(u+="; "+c,!0!==i[c]&&(u+="="+i[c]));return document.cookie=t+"="+o+u}t||(s={});for(var f=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;d<f.length;d++){var p=f[d].split("="),h=p.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var y=p[0].replace(l,decodeURIComponent);if(h=n.read?n.read(h,y):n(h,y)||h.replace(l,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(e){}if(t===y){s=h;break}t||(s[y]=h)}catch(e){}}return s}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}(function(){})},void 0!==(o="function"==typeof(r=i)?r.call(t,n,t,e):r)&&(e.exports=o),e.exports=i()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={oAuth:{endpoint:"/oauth2/auth",responseType:"token",clientId:"platform-client",providers:{facebook:!0,google:!0,linkedin:!0,wechat:!0},scope:"",state:"",redirectUri:window.location.href,accessTokenParam:"access_token",idTokenParam:"id_token",logout:{endpoint:"/oauth2/v1/logout",redirectUri:window.location.href}},account:{endpoint:"/api/labs-account/v1/accounts",schoolId:"",jwtHeader:"X-EF-ACCESS",refreshInterval:18e5},queryproxy:{endpoint:"/api/labs-school-proxy/v1/troop"},storage:{key:"efid_tokens"},autoStart:!1,autoRedirect:!1,prioritizeTokensFromHash:!1,keepTokensInHash:!1,domLogout:"platform-auth.logout"}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),s=n(5),a=r(s),u=n(2),c=r(u),f=n(1),l=r(f),d=(0,i.default)("platform-fe-auth:tokensRetrievers:stored");t.default=function(e){return new Promise(function(t,n){d("accessing storage with key %s...",e.storage.key);var r=a.default.get(e.storage.key);if(r){var o;d("parsing stored value...");try{o=JSON.parse(r)}catch(e){return n((0,c.default)("cannot parse stored tokens data",{type:l.default.RETRIEVE_STORED_TOKENS.INVALID}))}d("stored tokens: %j",o),t(o)}else d("failed to retrieve stored value"),n((0,c.default)("failed to retrieve stored value",{type:l.default.RETRIEVE_STORED_TOKENS.MISSING}))})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),s=n(2),a=r(s),u=n(1),c=r(u),f=(0,i.default)("platform-fe-auth:tokensRetrievers:efaccount");t.default=function(e,t){var n=[e.account.endpoint,["schoolId",encodeURIComponent(e.account.schoolId)].join("=")].join("?");return f("issuing HTTP GET to account service..."),fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}}).then(function(t){if(t.status>=400)throw f("account service responded with HTTP %d (%s)",t.status,t.statusText),(0,a.default)(t.statusText,{status:t.status,statusText:t.statusText,type:c.default.RETRIEVE_ACCOUNT_TOKEN.ACCOUNT_SERVICE_FAILURE});var n=t.headers.get(e.account.jwtHeader);return f("account token: %s",n),n})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),s=n(37),a=r(s),u=n(2),c=r(u),f=n(1),l=r(f),d=(0,i.default)("platform-fe-auth:tokensRetrievers:efid");t.default=function(e){return new Promise(function(t,n){d("getting URL hash params for access token and id token...");var r=Boolean(e.oAuth.idTokenParam),o=function(e){var t=(0,a.default)(e);return t?d("access token: %s",t):d("access token not found in URL hash"),t}(e.oAuth.accessTokenParam),i=r?function(e){var t=(0,a.default)(e);return t?d("id token: %s",t):d("id token not found in URL hash"),t}(e.oAuth.idTokenParam):void 0;!o||r&&!i?n((0,c.default)("Cannot find tokens in URL hash",{type:l.default.RETRIEVE_EFID_TOKENS.MISSING_TOKENS})):t({access:o,id:i})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace(/[\[\]]/g,"\\$&"),n=new RegExp("[#&]"+t+"(=([^&#]*)|&|#|$)"),r=n.exec(window.location.href);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),s=n(39),a=r(s),u=n(40),c=r(u),f=(0,i.default)("platform-fe-auth:validate");t.default=function(e,t){return t.imp_account?(f("validating impersonation JWT..."),(0,a.default)(e,t.imp_account)):(f("validating account JWT..."),(0,a.default)(e,t.account).then(function(){return f("validating access token..."),(0,c.default)(e,t.access)}))}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),s=n(6),a=r(s),u=n(2),c=r(u),f=n(1),l=r(f),d=(0,i.default)("platform-fe-auth:validate:accountJwt");t.default=function(e,t){return d("getting JWT expiration time..."),(0,a.default)(t).then(function(e){if(d("expiration time is: %d (%s)",e,new Date(e)),e<=Date.now())throw(0,c.default)("Account JWT expired",{type:l.default.VALIDATE_ACCOUNT_JWT.EXPIRED})},function(e){throw e.type===l.default.GET_JWT_EXPIRATION_TIME.MISSING_EXPIRATION_TIME?(0,c.default)("Account JWT missing expiration time",{type:l.default.VALIDATE_ACCOUNT_JWT.MISSING_EXPIRATION_TIME}):e.type===l.default.GET_JWT_EXPIRATION_TIME.INVALID?(0,c.default)("Account JWT invalid",{type:l.default.VALIDATE_ACCOUNT_JWT.INVALID}):e})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(o),s=n(2),a=r(s),u=n(1),c=r(u),f=(0,i.default)("platform-fe-auth:validate:accessToken");t.default=function(e,t){var n=[e.queryproxy.endpoint,["q","efid!current"].join("=")].join("?");return f("issuing HTTP GET to query proxy..."),fetch(n,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}}).then(function(e){if(e.status>=400)throw f("query proxy responded with HTTP %d (%s)",e.status,e.statusText),(0,a.default)(e.statusText,{status:e.status,statusText:e.statusText,type:c.default.VALIDATE_ACCESS_TOKEN.QUERY_PROXY_FAILURE});return e.text()},function(e){throw(0,a.default)(e&&e.message,{type:c.default.NETWORK_FAILURE})}).then(function(e){if(!e.length)throw f("query proxy returned an empty response"),(0,a.default)("Received empty data",{type:c.default.VALIDATE_ACCESS_TOKEN.QUERY_PROXY_EMPTY_RESPONSE})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.oAuth,n=t.providers,r=t.responseType,o=t.clientId,i=t.scope,s=t.redirectUri,a=t.endpoint,u=t.state,c=[];for(var f in n)n.hasOwnProperty(f)&&n[f]&&c.push(f);var l=[["response_type",encodeURIComponent(r)].join("="),["client_id",encodeURIComponent(o)].join("="),["scope",encodeURIComponent(i)].join("="),["redirect_uri",encodeURIComponent(s)].join("="),["providers",encodeURIComponent(c.join(","))].join("=")];return u&&l.push(["state",encodeURIComponent(u)].join("=")),a+"?"+l.join("&")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.oAuth,r=n.logout,o=n.clientId,i=r.endpoint,s=r.redirectUri;return i+"?"+[["client_id",encodeURIComponent(o)].join("="),["redirect_uri",encodeURIComponent(s)].join("="),["token",encodeURIComponent(t)].join("=")].join("&")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(0===t.length||window.location.hash.length<=1)){var r=t.filter(Boolean).map(function(e){return e.replace(/[\[\]]/g,"\\$&")}).join("|"),o=new RegExp("^(?:"+r+")(?:=|$)"),i=window.location.hash,s=i.substring(1).split("&"),a="#"+(s=s.filter(function(e){return!o.test(e)})).join("&");a!==i&&(window.history&&"function"==typeof window.history.replaceState?window.history.replaceState(null,null,a):window.location.hash=a)}}},function(e,t,n){"use strict";function r(){i._departing=!0,window.removeEventListener(o,r)}Object.defineProperty(t,"__esModule",{value:!0});var o="beforeunload",i={_started:!1,_departing:!1,start:function(){i._started||(i._started=!0,window.addEventListener(o,r))},isDeparting:function(){return i._departing}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return new Promise(function(t){setTimeout(t,e)})}}])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAccessToken=void 0;var r,o=n(3),i=((r=o)&&r.__esModule,n(1));t.getAccessToken=function(e){return s(e)};var s=function(e){return(0,i.getHashParameter)(e.oAuth.accessTokenParam||i.ACCESS_TOKEN_KEY)}},function(e,t,n){var r,o;
/*!
 * JavaScript Cookie v2.2.0
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=o),!0,e.exports=i(),!!0){var s=window.Cookies,a=window.Cookies=i();a.noConflict=function(){return window.Cookies=s,a}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}return function t(n){function r(t,o,i){var s;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}i.expires=i.expires?i.expires.toUTCString():"";try{s=JSON.stringify(o),/^[\{\[]/.test(s)&&(o=s)}catch(e){}o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var u="";for(var c in i)i[c]&&(u+="; "+c,!0!==i[c]&&(u+="="+i[c]));return document.cookie=t+"="+o+u}t||(s={});for(var f=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;d<f.length;d++){var p=f[d].split("="),h=p.slice(1).join("=");this.json||'"'!==h.charAt(0)||(h=h.slice(1,-1));try{var y=p[0].replace(l,decodeURIComponent);if(h=n.read?n.read(h,y):n(h,y)||h.replace(l,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(e){}if(t===y){s=h;break}t||(s[y]=h)}catch(e){}}return s}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}(function(){})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getConfig=t.saveSchoolID=t.getSchoolIDFromLocal=void 0;var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(1),s=n(3),a=(r=s)&&r.__esModule?r:{default:r};t.getSchoolIDFromLocal=function(e){var t=e||i.SCHOOL_ID_KEY;return a.default.get(t)},t.saveSchoolID=function(e,t){var n=e||i.SCHOOL_ID_KEY;a.default.set(n,t)},t.getConfig=function(e,t){var n=o({},e.account,{schoolId:t});return o({},e,{account:n})}}]).default});